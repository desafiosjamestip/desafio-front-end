{"ast":null,"code":"var _jsxFileName = \"/home/pierre/Documentos/projects/Q2/sprint6/icash/src/providers/CreditCards/index.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useState, useEffect, useContext } from \"react\";\nimport api from \"../../services/api\";\nimport { useAuth } from \"../../providers/Auth\";\nimport jwt_decode from \"jwt-decode\";\nimport toast from \"react-hot-toast\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CreditCardsContext = /*#__PURE__*/createContext({});\nexport const CreditCardsProvider = ({\n  children\n}) => {\n  _s();\n\n  const {\n    token\n  } = useAuth();\n  const decoded = jwt_decode(token);\n  const userId = Number(decoded.sub);\n  const [creditCards, setCreditCards] = useState([]);\n  useEffect(() => {\n    api.get(`/creditCards?userId=${userId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(response => setCreditCards(response.data)).catch(_ => toast.error(\"Algo saiu mal. Tente novamente.\"));\n  }, []); //eslint-disable-line\n\n  const addCreditCard = data => {\n    api.post(\"/creditCards\", { ...data,\n      userId\n    }, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(response => {\n      setCreditCards([...creditCards, response.data]);\n      toast.success(\"Cartão adicionado com sucesso!\");\n    }).catch(_ => toast.error(\"Algo saiu mal. Tente novamente.\"));\n  };\n\n  return /*#__PURE__*/_jsxDEV(CreditCardsContext.Provider, {\n    value: {\n      creditCards,\n      addCreditCard\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CreditCardsProvider, \"bM8yQn+nvugAvMgyJzR0ixBVKLU=\", false, function () {\n  return [useAuth];\n});\n\n_c = CreditCardsProvider;\nexport const useCreditCards = () => {\n  _s2();\n\n  return useContext(CreditCardsContext);\n};\n\n_s2(useCreditCards, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"CreditCardsProvider\");","map":{"version":3,"sources":["/home/pierre/Documentos/projects/Q2/sprint6/icash/src/providers/CreditCards/index.tsx"],"names":["createContext","useState","useEffect","useContext","api","useAuth","jwt_decode","toast","CreditCardsContext","CreditCardsProvider","children","token","decoded","userId","Number","sub","creditCards","setCreditCards","get","headers","Authorization","then","response","data","catch","_","error","addCreditCard","post","success","useCreditCards"],"mappings":";;;;AAAA,SACEA,aADF,EAEEC,QAFF,EAGEC,SAHF,EAIEC,UAJF,QAMO,OANP;AAOA,OAAOC,GAAP,MAAgB,oBAAhB;AACA,SAASC,OAAT,QAAwB,sBAAxB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,KAAP,MAAkB,iBAAlB;;AAmBA,MAAMC,kBAAkB,gBAAGR,aAAa,CACtC,EADsC,CAAxC;AAIA,OAAO,MAAMS,mBAAmB,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAA4C;AAAA;;AAC7E,QAAM;AAAEC,IAAAA;AAAF,MAAYN,OAAO,EAAzB;AACA,QAAMO,OAAO,GAAGN,UAAU,CAAUK,KAAV,CAA1B;AACA,QAAME,MAAM,GAAGC,MAAM,CAACF,OAAO,CAACG,GAAT,CAArB;AAEA,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgChB,QAAQ,CAAmB,EAAnB,CAA9C;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACdE,IAAAA,GAAG,CACAc,GADH,CAC0B,uBAAsBL,MAAO,EADvD,EAC0D;AACtDM,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAG,UAAST,KAAM;AAAjC;AAD6C,KAD1D,EAIGU,IAJH,CAISC,QAAD,IAAcL,cAAc,CAACK,QAAQ,CAACC,IAAV,CAJpC,EAKGC,KALH,CAKUC,CAAD,IAAOlB,KAAK,CAACmB,KAAN,CAAY,iCAAZ,CALhB;AAMD,GAPQ,EAON,EAPM,CAAT,CAP6E,CAcrE;;AAER,QAAMC,aAAa,GAAIJ,IAAD,IAA0B;AAC9CnB,IAAAA,GAAG,CACAwB,IADH,CAEI,cAFJ,EAGI,EAAE,GAAGL,IAAL;AAAWV,MAAAA;AAAX,KAHJ,EAII;AACEM,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAG,UAAST,KAAM;AAAjC;AADX,KAJJ,EAQGU,IARH,CAQSC,QAAD,IAAc;AAClBL,MAAAA,cAAc,CAAC,CAAC,GAAGD,WAAJ,EAAiBM,QAAQ,CAACC,IAA1B,CAAD,CAAd;AACAhB,MAAAA,KAAK,CAACsB,OAAN,CAAc,gCAAd;AACD,KAXH,EAYGL,KAZH,CAYUC,CAAD,IAAOlB,KAAK,CAACmB,KAAN,CAAY,iCAAZ,CAZhB;AAaD,GAdD;;AAgBA,sBACE,QAAC,kBAAD,CAAoB,QAApB;AAA6B,IAAA,KAAK,EAAE;AAAEV,MAAAA,WAAF;AAAeW,MAAAA;AAAf,KAApC;AAAA,cACGjB;AADH;AAAA;AAAA;AAAA;AAAA,UADF;AAKD,CArCM;;GAAMD,mB;UACOJ,O;;;KADPI,mB;AAuCb,OAAO,MAAMqB,cAAc,GAAG;AAAA;;AAAA,SAAM3B,UAAU,CAACK,kBAAD,CAAhB;AAAA,CAAvB;;IAAMsB,c","sourcesContent":["import {\n  createContext,\n  useState,\n  useEffect,\n  useContext,\n  ReactNode,\n} from \"react\";\nimport api from \"../../services/api\";\nimport { useAuth } from \"../../providers/Auth\";\nimport jwt_decode from \"jwt-decode\";\nimport toast from \"react-hot-toast\";\nimport { CreditCardData } from \"../../types/creditCardData\";\n\ninterface Decoded {\n  email: string;\n  iat: number;\n  exp: number;\n  sub: string;\n}\n\ninterface CreditCardsProviderProps {\n  children: ReactNode;\n}\n\ninterface CreditCardsProviderData {\n  creditCards: CreditCardData[];\n  addCreditCard: (data: CreditCardData) => void;\n}\n\nconst CreditCardsContext = createContext<CreditCardsProviderData>(\n  {} as CreditCardsProviderData\n);\n\nexport const CreditCardsProvider = ({ children }: CreditCardsProviderProps) => {\n  const { token } = useAuth();\n  const decoded = jwt_decode<Decoded>(token);\n  const userId = Number(decoded.sub);\n\n  const [creditCards, setCreditCards] = useState<CreditCardData[]>([]);\n\n  useEffect(() => {\n    api\n      .get<CreditCardData[]>(`/creditCards?userId=${userId}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      })\n      .then((response) => setCreditCards(response.data))\n      .catch((_) => toast.error(\"Algo saiu mal. Tente novamente.\"));\n  }, []); //eslint-disable-line\n\n  const addCreditCard = (data: CreditCardData) => {\n    api\n      .post(\n        \"/creditCards\",\n        { ...data, userId },\n        {\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      )\n      .then((response) => {\n        setCreditCards([...creditCards, response.data]);\n        toast.success(\"Cartão adicionado com sucesso!\");\n      })\n      .catch((_) => toast.error(\"Algo saiu mal. Tente novamente.\"));\n  };\n\n  return (\n    <CreditCardsContext.Provider value={{ creditCards, addCreditCard }}>\n      {children}\n    </CreditCardsContext.Provider>\n  );\n};\n\nexport const useCreditCards = () => useContext(CreditCardsContext);\n"]},"metadata":{},"sourceType":"module"}