{"ast":null,"code":"var _jsxFileName = \"/home/pierre/Documentos/projects/novo/desafio-frontend/src/providers/Products/index.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useState } from \"react\";\nimport jwt_decode from \"jwt-decode\";\nimport { useAuthLogin } from \"../Auth\";\nimport toast from \"react-hot-toast\";\nimport api from \"../../Services\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ProductsContext = /*#__PURE__*/createContext({});\nexport const ProductsProvider = ({\n  children\n}) => {\n  _s();\n\n  /*\n  openModal - faz o controle de abertura do modal de update, está aqui para ser compartilhado\n  nas pages necessárias\n  */\n  const [openModal, setOpenModal] = useState(false);\n  /*\n  codeProduct - recebe o id do produto (na page StoreBD) para realizar o update\n  */\n\n  const [codeProduct, setCodeProduct] = useState(0);\n  /*\n  token - token que vem do provider Auth\n  */\n\n  const {\n    token\n  } = useAuthLogin();\n  /*\n  a condicional abaixo verifica se o token exsite  e faz a decodificação no JWT\n  */\n\n  if (token) {\n    const decoded = jwt_decode(token);\n    localStorage.setItem(\"userId\", JSON.stringify(decoded.sub));\n  }\n  /*\n  userId - recebe o token decodificado pelo JWT\n   */\n\n\n  const userId = localStorage.getItem(\"userId\");\n  /*\n  store - recebe os produtos da api\n  */\n\n  const [store, setStore] = useState(JSON.parse(localStorage.getItem(\"store\") || \"[]\"));\n  /*\n  registerProducts - recebe os dados do formulário de cadastro e registra o produto na api\n  */\n\n  const registerProducts = data => {\n    api.post(\"/products\", { ...data,\n      userId\n    }, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(resp => {\n      setStore([...store, resp.data]);\n      toast.success(\"Produto adicionado ao registro geral!\");\n    }).catch(_ => toast.error(\"Não possível cadastrar, tente novamente.\"));\n  };\n  /*\n  updateProducts - realiza o update das informações dos produtos\n  */\n\n\n  const updateProducts = (data, productId) => {\n    api.patch(`/products/${productId}`, data, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(_ => {\n      toast.success(\"Produto atualizado com sucesso!\");\n    }).catch(_ => toast.error(\"Não foi possível atualizar os dados, tente novamente.\"));\n  };\n  /*\n  loadStore - tentativa de manter os produtos atualizados após o update\n  */\n\n\n  const loadStore = () => {\n    api.get(\"/products\", {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(resp => {\n      setStore(resp.data);\n    }).catch(err => console.log(err));\n  };\n\n  return /*#__PURE__*/_jsxDEV(ProductsContext.Provider, {\n    value: {\n      store,\n      setStore,\n      registerProducts,\n      updateProducts,\n      setOpenModal,\n      openModal,\n      setCodeProduct,\n      codeProduct,\n      loadStore\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 132,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ProductsProvider, \"MbQFgkZr4iuzshbBQUbltIc2+3M=\", false, function () {\n  return [useAuthLogin];\n});\n\n_c = ProductsProvider;\nexport const useProducts = () => {\n  _s2();\n\n  return useContext(ProductsContext);\n};\n\n_s2(useProducts, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductsProvider\");","map":{"version":3,"sources":["/home/pierre/Documentos/projects/novo/desafio-frontend/src/providers/Products/index.tsx"],"names":["createContext","useContext","useState","jwt_decode","useAuthLogin","toast","api","ProductsContext","ProductsProvider","children","openModal","setOpenModal","codeProduct","setCodeProduct","token","decoded","localStorage","setItem","JSON","stringify","sub","userId","getItem","store","setStore","parse","registerProducts","data","post","headers","Authorization","then","resp","success","catch","_","error","updateProducts","productId","patch","loadStore","get","err","console","log","useProducts"],"mappings":"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","sourcesContent":["import {\n  createContext,\n  Dispatch,\n  ReactNode,\n  SetStateAction,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport { ProductsData } from \"../../types/ProductsData\";\nimport { UpdateProductsData } from \"../../types/UpdateProductsData\";\n\nimport jwt_decode from \"jwt-decode\";\nimport { useAuthLogin } from \"../Auth\";\nimport toast from \"react-hot-toast\";\nimport api from \"../../Services\";\n\ninterface ProductsProviderProps {\n  children: ReactNode;\n}\n\ninterface ProductsDataProps {\n  store: ProductsData[] | UpdateProductsData[];\n  setStore: React.Dispatch<React.SetStateAction<ProductsData[]>>;\n  registerProducts: (data: ProductsData) => void;\n  updateProducts: (data: UpdateProductsData, productId: number) => void;\n  setOpenModal: Dispatch<SetStateAction<boolean>>;\n  openModal: boolean;\n  setCodeProduct: Dispatch<SetStateAction<number>>;\n  codeProduct: number;\n  loadStore: () => void;\n}\n\ninterface Decoded {\n  email: string;\n  iat: number;\n  exp: number;\n  sub: string;\n}\n\nexport const ProductsContext = createContext<ProductsDataProps>(\n  {} as ProductsDataProps\n);\n\nexport const ProductsProvider = ({ children }: ProductsProviderProps) => {\n  /*\n  openModal - faz o controle de abertura do modal de update, está aqui para ser compartilhado\n  nas pages necessárias\n  */\n  const [openModal, setOpenModal] = useState<boolean>(false);\n\n  /*\n  codeProduct - recebe o id do produto (na page StoreBD) para realizar o update\n  */\n  const [codeProduct, setCodeProduct] = useState(0);\n\n  /*\n  token - token que vem do provider Auth\n  */\n  const { token } = useAuthLogin();\n\n  /*\n  a condicional abaixo verifica se o token exsite  e faz a decodificação no JWT\n  */\n  if (token) {\n    const decoded = jwt_decode<Decoded>(token);\n    localStorage.setItem(\"userId\", JSON.stringify(decoded.sub));\n  }\n\n  /*\n  userId - recebe o token decodificado pelo JWT\n   */\n  const userId = localStorage.getItem(\"userId\");\n\n  /*\n  store - recebe os produtos da api\n  */\n  const [store, setStore] = useState<ProductsData[]>(\n    JSON.parse(localStorage.getItem(\"store\") || \"[]\")\n  );\n\n  /*\n  registerProducts - recebe os dados do formulário de cadastro e registra o produto na api\n  */\n  const registerProducts = (data: ProductsData) => {\n    api\n      .post(\n        \"/products\",\n        { ...data, userId },\n        { headers: { Authorization: `Bearer ${token}` } }\n      )\n      .then((resp) => {\n        setStore([...store, resp.data]);\n        toast.success(\"Produto adicionado ao registro geral!\");\n      })\n      .catch((_) => toast.error(\"Não possível cadastrar, tente novamente.\"));\n  };\n\n  /*\n  updateProducts - realiza o update das informações dos produtos\n  */\n  const updateProducts = (data: UpdateProductsData, productId: number) => {\n    api\n      .patch(`/products/${productId}`, data, {\n        headers: { Authorization: `Bearer ${token}` },\n      })\n      .then((_) => {\n        toast.success(\"Produto atualizado com sucesso!\");\n      })\n      .catch((_) =>\n        toast.error(\"Não foi possível atualizar os dados, tente novamente.\")\n      );\n  };\n\n  /*\n  loadStore - tentativa de manter os produtos atualizados após o update\n  */\n  const loadStore = () => {\n    api\n      .get(\"/products\", {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      })\n      .then((resp) => {\n        setStore(resp.data);\n      })\n      .catch((err) => console.log(err));\n  };\n\n  return (\n    <ProductsContext.Provider\n      value={{\n        store,\n        setStore,\n        registerProducts,\n        updateProducts,\n        setOpenModal,\n        openModal,\n        setCodeProduct,\n        codeProduct,\n        loadStore,\n      }}\n    >\n      {children}\n    </ProductsContext.Provider>\n  );\n};\n\nexport const useProducts = () => useContext(ProductsContext);\n"]},"metadata":{},"sourceType":"module"}