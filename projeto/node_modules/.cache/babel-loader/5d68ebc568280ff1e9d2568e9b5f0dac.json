{"ast":null,"code":"var _jsxFileName = \"/home/pierre/Documentos/projects/Q2/sprint6/icash/src/providers/UserProvider/index.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useCallback, useContext, useEffect, useState } from \"react\";\nimport api from \"../../services/api\";\nimport toast from \"react-hot-toast\";\nimport axios from \"axios\";\nimport { useAuth } from \"../Auth\";\nimport { useHistory } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UserContext = /*#__PURE__*/createContext({});\nexport const UserDataProvider = ({\n  children\n}) => {\n  _s();\n\n  const history = useHistory();\n  const token = localStorage.getItem(\"@iCash:token\") || \"\";\n  const [user, setUser] = useState({});\n  const {\n    login\n  } = useAuth();\n  const UpdateUser = useCallback((data, userId) => {\n    axios.patch(`https://api-icash.herokuapp.com/users/${userId}`, data, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(res => {\n      setUser(res.data);\n      toast.success(\"Dados atualizados com sucesso!\");\n    }).catch(err => {\n      toast.error(\"Oops, algo saiu mal. Tente novamente.\");\n    });\n  }, [token]);\n  useEffect(() => {\n    if (token) {\n      const userId = JSON.parse(localStorage.getItem(\"@iCash: userId\") || \"\");\n      api.get(`/users/${userId}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      }).then(res => setUser(res.data)).catch(res => console.log(res));\n    }\n  }, [token, UpdateUser, login]);\n\n  const deleteAccount = () => {\n    const userId = JSON.parse(localStorage.getItem(\"@iCash: userId\") || \"\");\n    api.delete(`/users/${userId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(_ => {\n      history.push(\"/\");\n      toast.success(\"A sua conta foi excluída.\");\n      localStorage.clear();\n    }).catch(err => toast.error(\"Algo saiu mal. Tente novamente.\"));\n  };\n\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      UpdateUser,\n      user,\n      deleteAccount\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this);\n};\n\n_s(UserDataProvider, \"ihZv9WHwyOXG7EVpctQxgR3uxTc=\", false, function () {\n  return [useHistory, useAuth];\n});\n\n_c = UserDataProvider;\nexport const useUpdate = () => {\n  _s2();\n\n  return useContext(UserContext);\n};\n\n_s2(useUpdate, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"UserDataProvider\");","map":{"version":3,"sources":["/home/pierre/Documentos/projects/Q2/sprint6/icash/src/providers/UserProvider/index.tsx"],"names":["createContext","useCallback","useContext","useEffect","useState","api","toast","axios","useAuth","useHistory","UserContext","UserDataProvider","children","history","token","localStorage","getItem","user","setUser","login","UpdateUser","data","userId","patch","headers","Authorization","then","res","success","catch","err","error","JSON","parse","get","console","log","deleteAccount","delete","_","push","clear","useUpdate"],"mappings":"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","sourcesContent":["import {\n  createContext,\n  ReactNode,\n  useCallback,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport api from \"../../services/api\";\nimport { userUpdateData } from \"../../types/userUpdateData\";\nimport toast from \"react-hot-toast\";\nimport axios from \"axios\";\nimport { userSignUpData } from \"../../types/userSignUpData\";\nimport { useAuth } from \"../Auth\";\nimport { useHistory } from \"react-router-dom\";\n\ninterface UserDataProps {\n  name: string;\n  email: string;\n  cashback: number;\n  city?: string;\n  cellphone?: number;\n  age?: number;\n}\n\ninterface UserProviderProps {\n  children: ReactNode;\n}\n\ninterface UserProviderData {\n  UpdateUser: (data: userUpdateData, userId: string) => void;\n  user: userSignUpData;\n  deleteAccount: () => void;\n}\n\nconst UserContext = createContext<UserProviderData>({} as UserProviderData);\n\nexport const UserDataProvider = ({ children }: UserProviderProps) => {\n  const history = useHistory();\n  const token = localStorage.getItem(\"@iCash:token\") || \"\";\n  const [user, setUser] = useState<userSignUpData>({} as userSignUpData);\n  const { login } = useAuth();\n\n  const UpdateUser = useCallback(\n    (data: userUpdateData, userId: string) => {\n      axios\n        .patch(`https://api-icash.herokuapp.com/users/${userId}`, data, {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        })\n        .then((res) => {\n          setUser(res.data);\n          toast.success(\"Dados atualizados com sucesso!\");\n        })\n        .catch((err) => {\n          toast.error(\"Oops, algo saiu mal. Tente novamente.\");\n        });\n    },\n    [token]\n  );\n\n  useEffect(() => {\n    if (token) {\n      const userId = JSON.parse(localStorage.getItem(\"@iCash: userId\") || \"\");\n      api\n        .get(`/users/${userId}`, {\n          headers: { Authorization: `Bearer ${token}` },\n        })\n        .then((res) => setUser(res.data))\n        .catch((res) => console.log(res));\n    }\n  }, [token, UpdateUser, login]);\n\n  const deleteAccount = () => {\n    const userId = JSON.parse(localStorage.getItem(\"@iCash: userId\") || \"\");\n    api\n      .delete(`/users/${userId}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      })\n      .then((_) => {\n        history.push(\"/\");\n        toast.success(\"A sua conta foi excluída.\");\n        localStorage.clear();\n      })\n      .catch((err) => toast.error(\"Algo saiu mal. Tente novamente.\"));\n  };\n\n  return (\n    <UserContext.Provider value={{ UpdateUser, user, deleteAccount }}>\n      {children}\n    </UserContext.Provider>\n  );\n};\n\nexport const useUpdate = () => useContext(UserContext);\n"]},"metadata":{},"sourceType":"module"}