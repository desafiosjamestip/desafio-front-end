{"ast":null,"code":"var _jsxFileName = \"/home/pierre/Documentos/projects/Q2/sprint6/icash/src/providers/Payment/index.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext } from \"react\";\nimport toast from \"react-hot-toast\";\nimport { useHistory } from \"react-router-dom\";\nimport api from \"../../services/api\";\nimport { useAuth } from \"../Auth\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PaymentContext = /*#__PURE__*/createContext({});\nexport const PaymentProvider = ({\n  children\n}) => {\n  _s();\n\n  const {\n    token\n  } = useAuth();\n  const userId = localStorage.getItem(\"@iCash: userId\");\n  const history = useHistory();\n\n  const payWithCard = () => history.push(\"/cardpayment\");\n\n  const payWithCashback = () => history.push(\"/cashbackpayment\");\n\n  const finishCardPay = valueToPay => {\n    console.log(userId);\n    const value = {\n      ammount: valueToPay\n    };\n    api.patch(\"/userCashback\", value, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(res => console.log(res)).then(() => toast.success(\"Compra finalizada\")).catch(() => toast.error(\"Oops, algo saiu mal. Tente novamente.\"));\n  };\n\n  const finishedCashbackPay = valueToPay => {\n    const value = {\n      userId: userId,\n      ammount: valueToPay\n    };\n    api.patch(`/userCashback/${userId}`, value, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(PaymentContext.Provider, {\n    value: {\n      payWithCard,\n      payWithCashback,\n      finishCardPay,\n      finishedCashbackPay\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PaymentProvider, \"KK/MVR2D5+/+Sgv+91b/Tg27Y88=\", false, function () {\n  return [useAuth, useHistory];\n});\n\n_c = PaymentProvider;\nexport const usePayment = () => {\n  _s2();\n\n  return useContext(PaymentContext);\n};\n\n_s2(usePayment, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"PaymentProvider\");","map":{"version":3,"sources":["/home/pierre/Documentos/projects/Q2/sprint6/icash/src/providers/Payment/index.tsx"],"names":["createContext","useContext","toast","useHistory","api","useAuth","PaymentContext","PaymentProvider","children","token","userId","localStorage","getItem","history","payWithCard","push","payWithCashback","finishCardPay","valueToPay","console","log","value","ammount","patch","headers","Authorization","then","res","success","catch","error","finishedCashbackPay","usePayment"],"mappings":";;;;AAAA,SACEA,aADF,EAGEC,UAHF,QAMO,OANP;AAOA,OAAOC,KAAP,MAAkB,iBAAlB;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,OAAOC,GAAP,MAAgB,oBAAhB;AACA,SAASC,OAAT,QAAwB,SAAxB;;AAaA,MAAMC,cAAc,gBAAGN,aAAa,CAClC,EADkC,CAApC;AAIA,OAAO,MAAMO,eAAe,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAwC;AAAA;;AACrE,QAAM;AAAEC,IAAAA;AAAF,MAAYJ,OAAO,EAAzB;AACA,QAAMK,MAAM,GAAGC,YAAY,CAACC,OAAb,CAAqB,gBAArB,CAAf;AACA,QAAMC,OAAO,GAAGV,UAAU,EAA1B;;AAEA,QAAMW,WAAW,GAAG,MAAMD,OAAO,CAACE,IAAR,CAAa,cAAb,CAA1B;;AAEA,QAAMC,eAAe,GAAG,MAAMH,OAAO,CAACE,IAAR,CAAa,kBAAb,CAA9B;;AAEA,QAAME,aAAa,GAAIC,UAAD,IAAwB;AAC5CC,IAAAA,OAAO,CAACC,GAAR,CAAYV,MAAZ;AAEA,UAAMW,KAAK,GAAG;AACZC,MAAAA,OAAO,EAAEJ;AADG,KAAd;AAIAd,IAAAA,GAAG,CACAmB,KADH,CACS,eADT,EAC0BF,KAD1B,EACiC;AAC7BG,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAG,UAAShB,KAAM;AAAjC;AADoB,KADjC,EAIGiB,IAJH,CAISC,GAAD,IAASR,OAAO,CAACC,GAAR,CAAYO,GAAZ,CAJjB,EAKGD,IALH,CAKQ,MAAMxB,KAAK,CAAC0B,OAAN,CAAc,mBAAd,CALd,EAMGC,KANH,CAMS,MAAM3B,KAAK,CAAC4B,KAAN,CAAY,uCAAZ,CANf;AAOD,GAdD;;AAgBA,QAAMC,mBAAmB,GAAIb,UAAD,IAAwB;AAClD,UAAMG,KAAK,GAAG;AACZX,MAAAA,MAAM,EAAEA,MADI;AAEZY,MAAAA,OAAO,EAAEJ;AAFG,KAAd;AAKAd,IAAAA,GAAG,CAACmB,KAAJ,CAAW,iBAAgBb,MAAO,EAAlC,EAAqCW,KAArC,EAA4C;AAC1CG,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAG,UAAShB,KAAM;AAAjC;AADiC,KAA5C;AAGD,GATD;;AAWA,sBACE,QAAC,cAAD,CAAgB,QAAhB;AACE,IAAA,KAAK,EAAE;AACLK,MAAAA,WADK;AAELE,MAAAA,eAFK;AAGLC,MAAAA,aAHK;AAILc,MAAAA;AAJK,KADT;AAAA,cAQGvB;AARH;AAAA;AAAA;AAAA;AAAA,UADF;AAYD,CAhDM;;GAAMD,e;UACOF,O,EAEFF,U;;;KAHLI,e;AAkDb,OAAO,MAAMyB,UAAU,GAAG;AAAA;;AAAA,SAAM/B,UAAU,CAACK,cAAD,CAAhB;AAAA,CAAnB;;IAAM0B,U","sourcesContent":["import {\n  createContext,\n  ReactNode,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport toast from \"react-hot-toast\";\nimport { useHistory } from \"react-router-dom\";\nimport api from \"../../services/api\";\nimport { useAuth } from \"../Auth\";\n\ninterface PaymentProviderProps {\n  children: ReactNode;\n}\n\ninterface PaymentProviderData {\n  payWithCard: () => void;\n  payWithCashback: () => void;\n  finishCardPay: (valueToPay: number) => void;\n  finishedCashbackPay: (valueToPay: number) => void;\n}\n\nconst PaymentContext = createContext<PaymentProviderData>(\n  {} as PaymentProviderData\n);\n\nexport const PaymentProvider = ({ children }: PaymentProviderProps) => {\n  const { token } = useAuth();\n  const userId = localStorage.getItem(\"@iCash: userId\");\n  const history = useHistory();\n\n  const payWithCard = () => history.push(\"/cardpayment\");\n\n  const payWithCashback = () => history.push(\"/cashbackpayment\");\n\n  const finishCardPay = (valueToPay: number) => {\n    console.log(userId);\n\n    const value = {\n      ammount: valueToPay,\n    };\n\n    api\n      .patch(\"/userCashback\", value, {\n        headers: { Authorization: `Bearer ${token}` },\n      })\n      .then((res) => console.log(res))\n      .then(() => toast.success(\"Compra finalizada\"))\n      .catch(() => toast.error(\"Oops, algo saiu mal. Tente novamente.\"));\n  };\n\n  const finishedCashbackPay = (valueToPay: number) => {\n    const value = {\n      userId: userId,\n      ammount: valueToPay,\n    };\n\n    api.patch(`/userCashback/${userId}`, value, {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n  };\n\n  return (\n    <PaymentContext.Provider\n      value={{\n        payWithCard,\n        payWithCashback,\n        finishCardPay,\n        finishedCashbackPay,\n      }}\n    >\n      {children}\n    </PaymentContext.Provider>\n  );\n};\n\nexport const usePayment = () => useContext(PaymentContext);\n"]},"metadata":{},"sourceType":"module"}