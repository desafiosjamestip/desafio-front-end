{"ast":null,"code":"var _jsxFileName = \"/home/pierre/Documentos/projects/Q2/sprint6/icash/src/providers/UserProvider/index.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useEffect, useState } from \"react\";\nimport api from \"../../services/api\";\nimport toast from \"react-hot-toast\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UserContext = /*#__PURE__*/createContext({});\nexport const UserDataProvider = ({\n  children\n}) => {\n  _s();\n\n  const token = localStorage.getItem(\"@iCash:token\") || \"\";\n  const [currentBalance, setCurrentBalance] = useState(0);\n  useEffect(() => {\n    if (token) {\n      const userId = JSON.parse(localStorage.getItem(\"@iCash: userId\") || \"\");\n      api.get(`/users/${userId}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      }).then(res => setCurrentBalance(res.data.cashback)).catch(res => console.log(res));\n    }\n  });\n\n  const UpdateUser = (data, userId) => {\n    axios.patch(`https://api-icash.herokuapp.com/users/${userId}`, data, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(_ => {\n      toast.success(\"Dados atualizados com sucesso!\");\n    }).catch(err => {\n      toast.error(\"Oops, algo saiu mal. Tente novamente.\");\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      UpdateUser,\n      currentBalance\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n};\n\n_s(UserDataProvider, \"B2cyJG9gwMxvBcVsFQmLfKnKVjI=\");\n\n_c = UserDataProvider;\nexport const useUpdate = () => {\n  _s2();\n\n  return useContext(UserContext);\n};\n\n_s2(useUpdate, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"UserDataProvider\");","map":{"version":3,"sources":["/home/pierre/Documentos/projects/Q2/sprint6/icash/src/providers/UserProvider/index.tsx"],"names":["createContext","useContext","useEffect","useState","api","toast","axios","UserContext","UserDataProvider","children","token","localStorage","getItem","currentBalance","setCurrentBalance","userId","JSON","parse","get","headers","Authorization","then","res","data","cashback","catch","console","log","UpdateUser","patch","_","success","err","error","useUpdate"],"mappings":";;;;AAAA,SACEA,aADF,EAGEC,UAHF,EAIEC,SAJF,EAKEC,QALF,QAMO,OANP;AAOA,OAAOC,GAAP,MAAgB,oBAAhB;AAEA,OAAOC,KAAP,MAAkB,iBAAlB;AAEA,OAAOC,KAAP,MAAkB,OAAlB;;AAWA,MAAMC,WAAW,gBAAGP,aAAa,CAAmB,EAAnB,CAAjC;AAEA,OAAO,MAAMQ,gBAAgB,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAqC;AAAA;;AACnE,QAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,cAArB,KAAwC,EAAtD;AACA,QAAM,CAACC,cAAD,EAAiBC,iBAAjB,IAAsCX,QAAQ,CAAS,CAAT,CAApD;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIQ,KAAJ,EAAW;AACT,YAAMK,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAWN,YAAY,CAACC,OAAb,CAAqB,gBAArB,KAA0C,EAArD,CAAf;AACAR,MAAAA,GAAG,CACAc,GADH,CACQ,UAASH,MAAO,EADxB,EAC2B;AACvBI,QAAAA,OAAO,EAAE;AAAEC,UAAAA,aAAa,EAAG,UAASV,KAAM;AAAjC;AADc,OAD3B,EAIGW,IAJH,CAISC,GAAD,IAASR,iBAAiB,CAACQ,GAAG,CAACC,IAAJ,CAASC,QAAV,CAJlC,EAKGC,KALH,CAKUH,GAAD,IAASI,OAAO,CAACC,GAAR,CAAYL,GAAZ,CALlB;AAMD;AACF,GAVQ,CAAT;;AAYA,QAAMM,UAAU,GAAG,CAACL,IAAD,EAAuBR,MAAvB,KAA0C;AAC3DT,IAAAA,KAAK,CACFuB,KADH,CACU,yCAAwCd,MAAO,EADzD,EAC4DQ,IAD5D,EACkE;AAC9DJ,MAAAA,OAAO,EAAE;AACPC,QAAAA,aAAa,EAAG,UAASV,KAAM;AADxB;AADqD,KADlE,EAMGW,IANH,CAMSS,CAAD,IAAO;AACXzB,MAAAA,KAAK,CAAC0B,OAAN,CAAc,gCAAd;AACD,KARH,EASGN,KATH,CASUO,GAAD,IAAS;AACd3B,MAAAA,KAAK,CAAC4B,KAAN,CAAY,uCAAZ;AACD,KAXH;AAYD,GAbD;;AAeA,sBACE,QAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AAAEL,MAAAA,UAAF;AAAcf,MAAAA;AAAd,KAA7B;AAAA,cACGJ;AADH;AAAA;AAAA;AAAA;AAAA,UADF;AAKD,CApCM;;GAAMD,gB;;KAAAA,gB;AAsCb,OAAO,MAAM0B,SAAS,GAAG;AAAA;;AAAA,SAAMjC,UAAU,CAACM,WAAD,CAAhB;AAAA,CAAlB;;IAAM2B,S","sourcesContent":["import {\n  createContext,\n  ReactNode,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport api from \"../../services/api\";\nimport { userUpdateData } from \"../../types/userUpdateData\";\nimport toast from \"react-hot-toast\";\nimport { useAuth } from \"../Auth\";\nimport axios from \"axios\";\n\ninterface UserProviderProps {\n  children: ReactNode;\n}\n\ninterface UserProviderData {\n  UpdateUser: (data: userUpdateData, userId: string) => void;\n  currentBalance: number;\n}\n\nconst UserContext = createContext<UserProviderData>({} as UserProviderData);\n\nexport const UserDataProvider = ({ children }: UserProviderProps) => {\n  const token = localStorage.getItem(\"@iCash:token\") || \"\";\n  const [currentBalance, setCurrentBalance] = useState<number>(0);\n\n  useEffect(() => {\n    if (token) {\n      const userId = JSON.parse(localStorage.getItem(\"@iCash: userId\") || \"\");\n      api\n        .get(`/users/${userId}`, {\n          headers: { Authorization: `Bearer ${token}` },\n        })\n        .then((res) => setCurrentBalance(res.data.cashback))\n        .catch((res) => console.log(res));\n    }\n  });\n\n  const UpdateUser = (data: userUpdateData, userId: string) => {\n    axios\n      .patch(`https://api-icash.herokuapp.com/users/${userId}`, data, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      })\n      .then((_) => {\n        toast.success(\"Dados atualizados com sucesso!\");\n      })\n      .catch((err) => {\n        toast.error(\"Oops, algo saiu mal. Tente novamente.\");\n      });\n  };\n\n  return (\n    <UserContext.Provider value={{ UpdateUser, currentBalance }}>\n      {children}\n    </UserContext.Provider>\n  );\n};\n\nexport const useUpdate = () => useContext(UserContext);\n"]},"metadata":{},"sourceType":"module"}